# Union-Find (Disjoint Set Union, DSU)

Union-Findï¼ˆåˆç¨±`ä¸¦æŸ¥é›†`æˆ–`Disjoint Set Union`, DSUï¼‰æ˜¯ä¸€ç¨®ç”¨æ–¼è™•ç†å‹•æ…‹é€£é€šæ€§å•é¡Œçš„è³‡æ–™çµæ§‹ã€‚å®ƒå¸¸ç”¨æ–¼åœ–è«–æ¼”ç®—æ³•ä¸­ï¼Œç‰¹åˆ¥æ˜¯åœ¨éœ€è¦åˆä½µé›†åˆæˆ–åˆ¤æ–·æ˜¯å¦å±¬æ–¼åŒä¸€é›†åˆçš„æƒ…å¢ƒï¼Œå¦‚é€£é€šåœ–åˆ¤æ–·ã€æœ€å°ç”Ÿæˆæ¨¹ï¼ˆKruskal's Algorithmï¼‰ä»¥åŠç¶²è·¯é€£é€šæ€§å•é¡Œç­‰ã€‚ ç¶“å…¸å³¶å¶¼å•é¡Œä¹Ÿå¯ä»¥ä½¿ç”¨ Union-Find é€²è¡Œè§£é¡Œ (åˆ¤æ–·å‘¨åœçš„å€å¡Šæ˜¯å¦è·Ÿè‡ªå·±äº«æœ‰å…±åŒçš„ root)ã€‚

## ç‰¹é»ž
- èƒ½é«˜æ•ˆåˆä½µå…©å€‹é›†åˆ(`union`æ“ä½œ)
- èƒ½å¿«é€ŸæŸ¥æ‰¾æŸå€‹å…ƒç´ å±¬æ–¼å“ªå€‹é›†åˆ(`find`æ“ä½œ)
- é€éŽ`è·¯å¾‘å£“ç¸®`åŠ`Rankå„ªåŒ–`æå‡æ•ˆçŽ‡ï¼Œä½¿æ¯ä¸€æ¬¡`union`æˆ–æ˜¯`find`æ“ä½œæŽ¥è¿‘å¸¸æ•¸æ™‚é–“ã€‚

## ä¸»è¦æ“ä½œ

### `find(x)`: æŸ¥æ‰¾å…ƒç´  `x` çš„`æ ¹ï¼ˆrootï¼‰`
- å¦‚æžœ `x` æ˜¯é›†åˆçš„ä»£è¡¨ï¼Œå‰‡è¿”å›ž `x` æœ¬èº«ã€‚  
- å¦å‰‡ï¼Œéžè¿´æŸ¥æ‰¾ `x` çš„çˆ¶ç¯€é»žï¼Œä¸¦**å£“ç¸®è·¯å¾‘**ï¼ˆè®“ `x` ç›´æŽ¥é€£åˆ° rootï¼‰ï¼Œä»¥åŠ é€Ÿæœªä¾†çš„æŸ¥æ‰¾ã€‚  

ä¸€èˆ¬æœƒä½¿ç”¨ä¸‹æ–¹çš„ pattern
```python
def find(x):
    if parent[x] != x:
        # è·¯å¾‘å£“ç¸®ï¼š
        # å°‡ x ç›´æŽ¥æŒ‡å‘å…¶ä»£è¡¨ç¯€é»ž rootï¼Œä»¥æ¸›å°‘æœªä¾†çš„æŸ¥æ‰¾æ­¥é©Ÿ
        parent[x] = find(parent[x]) 
    return parent[x]
```

### `union(x, y)`: åˆä½µ `x` å’Œ `y` æ‰€åœ¨çš„é›†åˆ
- å…ˆé€éŽ `find(x)` å’Œ `find(y)` æ‰¾åˆ°å„è‡ªçš„`æ ¹ç¯€é»ž`ã€‚
- ä½¿ç”¨ `Rank å„ªåŒ–`ï¼š
    - è‹¥ `rank[root_x]` > `rank[root_y]`ï¼Œå‰‡ `root_y` æŽ¥åˆ° `root_x`ã€‚
    - åä¹‹å‰‡ `root_y` æŽ¥åˆ° `root_x`ã€‚
    - è‹¥å…©é‚Š `Rank` ç›¸ç­‰ï¼Œå‰‡ `root_y` æŽ¥åˆ° `root_x`ï¼Œä¸¦å¢žåŠ  `root_x`çš„ `Rank`ã€‚

Union æ“ä½œä¹Ÿå¸¸è¦‹å¦‚ä¸‹çš„pattern
```python
def union(x, y):
    root_x = find(x)
    root_y = find(y)
    
    if root_x != root_y:
        # Rank å„ªåŒ–ï¼šæ¯”è¼ƒå…©å€‹é›†åˆçš„ç§©ï¼ˆæ¨¹çš„é«˜åº¦ï¼‰ï¼Œå°‡è¼ƒå°çš„æ¨¹åˆä½µåˆ°è¼ƒå¤§çš„æ¨¹
        if rank[root_x] > rank[root_y]:
            parent[root_y] = root_x
        elif rank[root_x] < rank[root_y]:
            parent[root_x] = root_y
        else:
             # å¦‚æžœ x å’Œ y çš„æ¨¹é«˜åº¦ç›¸åŒï¼Œ
             # éš¨ä¾¿å°‡ä¸€å€‹åˆä½µåˆ°å¦ä¸€å€‹ï¼Œä¸¦ä¸”å¢žåŠ åˆä½µå¾Œæ¨¹çš„é«˜åº¦
            parent[root_y] = root_x
            rank[root_x] += 1 # å¢žåŠ æ ¹ç¯€é»žçš„ rankï¼ˆæ¨¹çš„é«˜åº¦ï¼‰
```

**ðŸ’¡è·¯å¾‘å£“ç¸®è®“å¾ŒçºŒçš„ find æ“ä½œå¯ä»¥åœ¨å¸¸æ•¸æ™‚é–“ `O(1)`å…§å®Œæˆ**

**ðŸ’¡é€éŽæ¯”è¼ƒ `Rank` ä¾†é€²è¡Œ `Union` æ“ä½œï¼Œå¯ä»¥ä¿è­‰åˆä½µæ™‚æ¨¹çš„æ·±åº¦ä¸æœƒéŽå¤§ï¼Œå¾žè€Œæ¸›å°‘æœªä¾†åŸ·è¡Œ Find æ“ä½œæ™‚éœ€è¦éæ­·(traversing) çš„æ¬¡æ•¸ã€‚**

## æ‡‰ç”¨å ´æ™¯
- é€£é€šæ€§å•é¡Œ (åˆ¤æ–·å…©å€‹ç¯€é»žæ˜¯å¦åœ¨åŒä¸€å€‹groupå…§)
- ç¾¤çµ„åˆä½µå•é¡Œ
- ç­‰å¼èˆ‡ä¸ç­‰å¼å•é¡Œ

## è¤‡é›œåº¦åˆ†æž
### æ™‚é–“è¤‡é›œåº¦ï¼š
- `find` èˆ‡ `union` æ“ä½œæŽ¥ç´„ç•¥ç­‰æ–¼å¸¸æ•¸æ™‚é–“ï¼Œäº¦å³ `O(1)`ã€‚
    (å¯¦å‰‡ç‚º`O(Î±(n))`ï¼Œå…¶ä¸­Î±(n)ç‚ºé˜¿å…‹æ›¼å‡½æ•¸çš„åå‡½æ•¸)
- åœ¨è™•ç† m æ¬¡æ“ä½œçš„æƒ…æ³ä¸‹ï¼Œå¯ä»¥è¦–ç‚º `O(m)`
### ç©ºé–“è¤‡é›œåº¦
- `O(n)`ï¼šç”¨æ–¼å„²å­˜ `root` åŠ `rank`

## ç¶“å…¸é¡Œç›®
- [684. Redundant Connection](https://leetcode.com/problems/redundant-connection)
    - å¦‚æžœç™¼ç¾æŸæ¢é‚Šåœ¨åŸ·è¡Œ union æ“ä½œå‰å°±å·²ç¶“æœ‰å…±åŒçš„rootï¼Œè¡¨ç¤ºåœ–å…§å‡ºç¾ç’°äº†ã€‚
- [2685. Count the Number of Complete Components](https://leetcode.com/problems/count-the-number-of-complete-components)

